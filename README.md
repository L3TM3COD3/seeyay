# Ğ¡Ğ˜Ğ¯Ğ™ AI - Telegram Ğ±Ğ¾Ñ‚ Ğ´Ğ»Ñ Ğ½ĞµĞ¹Ñ€Ğ¾Ñ„Ğ¾Ñ‚Ğ¾ÑĞµÑÑĞ¸Ğ¹

Telegram Ğ±Ğ¾Ñ‚ Ñ Mini App Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ AI-Ñ„Ğ¾Ñ‚Ğ¾ÑĞµÑÑĞ¸Ğ¹ Ğ² Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… ÑÑ‚Ğ¸Ğ»ÑÑ… Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ¾Ğ¹ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹.

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Google Cloud (europe-west4)                      â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Cloud Run   â”‚  â”‚  Cloud Run   â”‚  â”‚  Cloud Run   â”‚              â”‚
â”‚  â”‚    Bot       â”‚  â”‚    API       â”‚  â”‚  Mini App    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                 â”‚                                          â”‚
â”‚         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚         â”‚    â”‚                         â”‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   Firestore  â”‚  â”‚Secret Managerâ”‚  â”‚  Vertex AI   â”‚             â”‚
â”‚  â”‚   Database   â”‚  â”‚   (secrets)  â”‚  â”‚ (Gemini API) â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ Cloud Scheduler  â”‚  â”‚  CloudPayments API â”‚ (external)           â”‚
â”‚  â”‚  (Cron Jobs)     â”‚  â”‚    + Ğ¡Ğ‘ĞŸ           â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸

### ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸
- ğŸ¨ Ğ“Ğ°Ğ»ĞµÑ€ĞµÑ ÑÑ‚Ğ¸Ğ»ĞµĞ¹ Ñ„Ğ¾Ñ‚Ğ¾ÑĞµÑÑĞ¸Ğ¹ Ñ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸ÑĞ¼Ğ¸
- ğŸ‘¤ ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ñ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ¾Ğ¼ ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸ (âš¡)
- ğŸ–¼ï¸ Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ñ„Ğ¾Ñ‚Ğ¾ Ğ² ÑÑ‚Ğ¸Ğ»Ğµ (ĞĞ±Ñ‹Ñ‡Ğ½Ñ‹Ğ¹ = 1âš¡, PRO = 2âš¡)
- ğŸ“œ Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
- ğŸ’¡ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¸ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸

### ĞŸĞ»Ğ°Ñ‚ĞµĞ¶Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°
- ğŸ’³ **ĞŸĞ¾ĞºÑƒĞ¿ĞºĞ° Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ² ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸** (ĞµĞ´Ğ¸Ğ½Ğ¾Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ¾)
  - 10âš¡ = 99â‚½
  - 30âš¡ = 249â‚½
  - 100âš¡ = 699â‚½
- ğŸ”„ **ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸ Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¿Ñ€Ğ¾Ğ´Ğ»ĞµĞ½Ğ¸ĞµĞ¼**
  - Free: 1âš¡ Ğ² Ğ´ĞµĞ½ÑŒ (Ğ±ĞµÑĞ¿Ğ»Ğ°Ñ‚Ğ½Ğ¾)
  - Basic: 30âš¡/Ğ¼ĞµÑ. Ğ·Ğ° 499â‚½
  - PRO: 150âš¡/Ğ¼ĞµÑ. Ğ·Ğ° 1299â‚½
- ğŸ¦ **ĞĞ¿Ğ»Ğ°Ñ‚Ğ° Ñ‡ĞµÑ€ĞµĞ· Ğ¡Ğ‘ĞŸ** (QR-ĞºĞ¾Ğ´ + deeplink)
- ğŸ“± **ĞĞ½Ğ»Ğ°Ğ¹Ğ½-Ñ‡ĞµĞºĞ¸** (54-Ğ¤Ğ—) Ñ‡ĞµÑ€ĞµĞ· CloudKassir
- ğŸ” **ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ retry** Ğ¿Ñ€Ğ¸ Ğ½ĞµÑƒĞ´Ğ°Ñ‡Ğ½Ñ‹Ñ… Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ°Ñ…
- ğŸ **Win-back ÑĞºĞ¸Ğ´ĞºĞ¸ 25%** Ğ´Ğ»Ñ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚Ğ° Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‡Ğ¸ĞºĞ¾Ğ²

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
Seeyay.ai/
â”œâ”€â”€ bot/                       # Telegram Ğ±Ğ¾Ñ‚ (aiogram)
â”‚   â”œâ”€â”€ Dockerfile         
â”‚   â”œâ”€â”€ handlers/              # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¸ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´
â”‚   â”‚   â”œâ”€â”€ start.py          # /start ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°
â”‚   â”‚   â”œâ”€â”€ photo.py          # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ñ„Ğ¾Ñ‚Ğ¾ + ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸
â”‚   â”‚   â””â”€â”€ webapp.py         # Web App Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
â”‚   â”œâ”€â”€ services/              # Ğ¡ĞµÑ€Ğ²Ğ¸ÑÑ‹
â”‚   â”‚   â””â”€â”€ vertex_ai.py      # Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· Vertex AI
â”‚   â”œâ”€â”€ firestore.py           # Firestore Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
â”‚   â””â”€â”€ main.py            
â”‚
â”œâ”€â”€ backend/                   # FastAPI ÑĞµÑ€Ğ²ĞµÑ€
â”‚   â”œâ”€â”€ Dockerfile         
â”‚   â”œâ”€â”€ routers/               # API endpoints
â”‚   â”‚   â”œâ”€â”€ styles.py         # Ğ¡Ñ‚Ğ¸Ğ»Ğ¸
â”‚   â”‚   â”œâ”€â”€ users.py          # ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸
â”‚   â”‚   â”œâ”€â”€ payments.py       # ĞŸĞ»Ğ°Ñ‚ĞµĞ¶Ğ¸ Ğ¸ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸
â”‚   â”‚   â”œâ”€â”€ webhooks.py       # CloudPayments webhooks
â”‚   â”‚   â”œâ”€â”€ cron.py           # Cron endpoints
â”‚   â”‚   â””â”€â”€ generate.py       # Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ
â”‚   â”œâ”€â”€ services/              # Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°
â”‚   â”‚   â”œâ”€â”€ cloudpayments.py  # CloudPayments ĞºĞ»Ğ¸ĞµĞ½Ñ‚
â”‚   â”‚   â”œâ”€â”€ subscription.py   # Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°Ğ¼Ğ¸
â”‚   â”‚   â””â”€â”€ notifications.py  # Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ² Telegram
â”‚   â”œâ”€â”€ firestore.py           # Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Firestore
â”‚   â”œâ”€â”€ secrets.py             # Secret Manager
â”‚   â””â”€â”€ main.py            
â”‚
â”œâ”€â”€ mini-app/                  # React Mini App
â”‚   â”œâ”€â”€ Dockerfile         
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/       # React ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
â”‚   â”‚   â”‚   â”œâ”€â”€ Gallery.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Profile.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ PaymentModal.tsx   # CloudPayments Ğ²Ğ¸Ğ´Ğ¶ĞµÑ‚
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â””â”€â”€ EnergyPage.tsx     # ĞŸĞ¾ĞºÑƒĞ¿ĞºĞ° ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸/Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¾Ğº
â”‚   â”‚   â””â”€â”€ api/
â”‚   â”‚       â””â”€â”€ client.ts          # API ĞºĞ»Ğ¸ĞµĞ½Ñ‚
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ cloudbuild.yaml            # CI/CD ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
â”œâ”€â”€ deploy.sh                  # Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ´ĞµĞ¿Ğ»Ğ¾Ñ
â”œâ”€â”€ CLOUDPAYMENTS_SETUP.md     # Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞµ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹
â””â”€â”€ requirements.txt       
```

## âš™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Google Cloud

### 1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```bash
# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Ğ¸Ğ»Ğ¸ Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹
gcloud projects create seeyay-ai --name="Ğ¡Ğ˜Ğ¯Ğ™ AI"
gcloud config set project seeyay-ai
```

### 2. Ğ’ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ API

```bash
gcloud services enable \
    cloudbuild.googleapis.com \
    run.googleapis.com \
    secretmanager.googleapis.com \
    firestore.googleapis.com \
    aiplatform.googleapis.com \
    cloudscheduler.googleapis.com
```

### 3. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞµĞºÑ€ĞµÑ‚Ğ¾Ğ²

```bash
# Telegram Bot Token (Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚Ğµ Ñƒ @BotFather)
echo -n "YOUR_BOT_TOKEN" | gcloud secrets create telegram-bot-token \
    --data-file=- --replication-policy="automatic"

# CloudPayments Public ID
echo -n "YOUR_PUBLIC_ID" | gcloud secrets create cloudpayments-public-id \
    --data-file=- --replication-policy="automatic"

# CloudPayments API Secret
echo -n "YOUR_API_SECRET" | gcloud secrets create cloudpayments-api-secret \
    --data-file=- --replication-policy="automatic"

# Cron Auth Token (Ğ´Ğ»Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸ cron endpoints)
openssl rand -base64 32 | gcloud secrets create cron-auth-token \
    --data-file=- --replication-policy="automatic"
```

### 4. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Firestore

```bash
# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ±Ğ°Ğ·Ñƒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Firestore Ğ² Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ Native
gcloud firestore databases create --location=europe-west4
```

## ğŸš€ Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹

### ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹ Ñ‡ĞµÑ€ĞµĞ· Cloud Build

```bash
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
export GCP_PROJECT_ID=your-project-id
export GCP_REGION=europe-west4

# Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹
./deploy.sh
```

### Ğ ÑƒÑ‡Ğ½Ğ¾Ğ¹ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹

```bash
# Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ğ¸ Ğ¿ÑƒÑˆ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²
gcloud builds submit . --config=cloudbuild.yaml
```

## ğŸ’³ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° CloudPayments

ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ñ‹Ğµ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸ Ğ² **[CLOUDPAYMENTS_SETUP.md](CLOUDPAYMENTS_SETUP.md)**

### ĞšÑ€Ğ°Ñ‚ĞºĞ¸Ğ¹ Ñ‡ĞµĞºĞ»Ğ¸ÑÑ‚:
1. âœ… Ğ—Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ Ğ½Ğ° [CloudPayments](https://cloudpayments.ru)
2. âœ… ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Public ID Ğ¸ API Secret
3. âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ÑĞµĞºÑ€ĞµÑ‚Ñ‹ Ğ² Secret Manager
4. âœ… ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ webhook'Ğ¸ Ğ² Ğ»Ğ¸Ñ‡Ğ½Ğ¾Ğ¼ ĞºĞ°Ğ±Ğ¸Ğ½ĞµÑ‚Ğµ CloudPayments
5. âœ… ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¾Ğ½Ğ»Ğ°Ğ¹Ğ½-ĞºĞ°ÑÑÑƒ CloudKassir
6. âœ… ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Cloud Scheduler jobs

## ğŸ’» Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°

### 1. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ

```bash
# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ²Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
python -m venv venv

# ĞĞºÑ‚Ğ¸Ğ²Ğ°Ñ†Ğ¸Ñ (Windows)
venv\Scripts\activate

# ĞĞºÑ‚Ğ¸Ğ²Ğ°Ñ†Ğ¸Ñ (Linux/Mac)
source venv/bin/activate

# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹
pip install -r requirements.txt
```

### 2. ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ñ„Ğ°Ğ¹Ğ» `.env`:

```env
BOT_TOKEN=your_telegram_bot_token
GCP_PROJECT_ID=your-gcp-project-id
GCP_LOCATION=europe-west4
BACKEND_URL=http://localhost:8000
MINI_APP_URL=http://localhost:3000
CLOUDPAYMENTS_PUBLIC_ID=test_api_xxx
CLOUDPAYMENTS_API_SECRET=test_secret_xxx
```

### 3. ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ GCP

```bash
# Ğ”Ğ»Ñ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸
gcloud auth application-default login
```

### 4. Ğ—Ğ°Ğ¿ÑƒÑĞº

```bash
# Backend
python -m uvicorn backend.main:app --reload --port 8000

# Bot
python -m bot.main

# Mini App
cd mini-app
npm install
npm run dev
```

## ğŸ—„ï¸ API Endpoints

### ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|-------|------|----------|
| GET | /api/health | Health check |
| GET | /api/styles | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ÑÑ‚Ğ¸Ğ»ĞµĞ¹ |
| GET | /api/styles/{id} | Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ÑÑ‚Ğ¸Ğ»Ğµ |
| GET | /api/users/{telegram_id} | ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ |
| POST | /api/users | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ |
| PATCH | /api/users/{id}/balance | ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ |

### ĞŸĞ»Ğ°Ñ‚ĞµĞ¶Ğ¸

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|-------|------|----------|
| GET | /api/payments/packs | ĞŸĞ°ĞºĞµÑ‚Ñ‹ ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸ |
| GET | /api/payments/plans | Ğ¢Ğ°Ñ€Ğ¸Ñ„Ğ½Ñ‹Ğµ Ğ¿Ğ»Ğ°Ğ½Ñ‹ |
| POST | /api/payments/create-pack-payment | Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹ Ğ¿Ğ°ĞºĞµÑ‚Ğ° |
| POST | /api/payments/create-subscription | Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸ |
| POST | /api/payments/sbp/create | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¡Ğ‘ĞŸ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ° |
| POST | /api/payments/cancel-subscription | ĞÑ‚Ğ¼ĞµĞ½Ğ° Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸ |
| POST | /api/payments/resume-subscription | Ğ’Ğ¾Ğ·Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸ |

### Webhooks (CloudPayments)

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|-------|------|----------|
| POST | /api/webhooks/cloudpayments/check | ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ° |
| POST | /api/webhooks/cloudpayments/pay | Ğ£ÑĞ¿ĞµÑˆĞ½Ğ°Ñ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ğ° |
| POST | /api/webhooks/cloudpayments/fail | ĞĞµÑƒĞ´Ğ°Ñ‡Ğ½Ğ°Ñ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ğ° |
| POST | /api/webhooks/cloudpayments/recurrent | Ğ ĞµĞºÑƒÑ€Ñ€ĞµĞ½Ñ‚Ğ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ñ‚Ñ‘Ğ¶ |
| POST | /api/webhooks/cloudpayments/refund | Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ |

### Cron Jobs

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|-------|------|----------|------------|
| POST | /api/cron/daily-energy | ĞĞ°Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ 1âš¡ free Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼ | 00:00 ĞœĞ¡Ğš |
| POST | /api/cron/subscription-retry | Retry Ğ½ĞµÑƒĞ´Ğ°Ñ‡Ğ½Ñ‹Ñ… Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹ | ĞšĞ°Ğ¶Ğ´Ñ‹Ğµ 30 Ğ¼Ğ¸Ğ½ |
| POST | /api/cron/subscription-status | ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ¾Ğ² Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¾Ğº | ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ‡Ğ°Ñ |

## ğŸ¨ Ğ¡Ñ‚Ğ¸Ğ»Ğ¸

Ğ¡Ñ‚Ğ¸Ğ»Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ñ‹ Ğ² `backend/styles_data.py` Ğ¸ `bot/styles_data.py`. ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ ÑÑ‚Ğ¸Ğ»ÑŒ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚:
- `id` - ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€
- `name` - Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ° Ñ€ÑƒÑÑĞºĞ¾Ğ¼
- `category` - ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ (effect, look, new, trending, for_her, for_him)
- `image` - Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ¿Ñ€ĞµĞ²ÑŒÑ
- `prompt` - Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚ Ğ´Ğ»Ñ Vertex AI

## ğŸ’ Ğ¢Ğ°Ñ€Ğ¸Ñ„Ñ‹ Ğ¸ Ñ†ĞµĞ½Ñ‹

### ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸

| Ğ¢Ğ°Ñ€Ğ¸Ñ„ | Ğ¦ĞµĞ½Ğ° | Ğ­Ğ½ĞµÑ€Ğ³Ğ¸Ñ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|-------|------|---------|----------|
| **Free** | 0â‚½/Ğ¼ĞµÑ. | 1âš¡ Ğ² Ğ´ĞµĞ½ÑŒ | ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ÑÑ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ² 00:00 ĞœĞ¡Ğš |
| **Basic** | 499â‚½/Ğ¼ĞµÑ. | 30âš¡/Ğ¼ĞµÑ. | ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ¹ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ğµ |
| **PRO** | 1299â‚½/Ğ¼ĞµÑ. | 150âš¡/Ğ¼ĞµÑ. | ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ¹ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ğµ |

### ĞŸĞ°ĞºĞµÑ‚Ñ‹ ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸ (ĞµĞ´Ğ¸Ğ½Ğ¾Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ¾)

| ĞŸĞ°ĞºĞµÑ‚ | Ğ¦ĞµĞ½Ğ° | Ğ­Ğ½ĞµÑ€Ğ³Ğ¸Ñ |
|-------|------|---------|
| ĞœĞ°Ğ»ĞµĞ½ÑŒĞºĞ¸Ğ¹ | 99â‚½ | 10âš¡ |
| Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ | 249â‚½ | 30âš¡ |
| Ğ‘Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ | 699â‚½ | 100âš¡ |

### Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸

- **ĞĞ±Ñ‹Ñ‡Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼**: 1âš¡ Ğ·Ğ° 1 Ñ„Ğ¾Ñ‚Ğ¾
- **PRO Ñ€ĞµĞ¶Ğ¸Ğ¼**: 2âš¡ Ğ·Ğ° 1 Ñ„Ğ¾Ñ‚Ğ¾

## ğŸ”„ Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¾Ğº

### Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸

| Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|--------|----------|
| **active** | ĞĞ¿Ğ»Ğ°Ñ‡ĞµĞ½Ğ¾, Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ ĞµÑÑ‚ÑŒ |
| **grace** | ĞŸĞ»Ğ°Ñ‚Ñ‘Ğ¶ Ğ½Ğµ Ğ¿Ñ€Ğ¾ÑˆÑ‘Ğ», Ğ¸Ğ´Ñ‘Ñ‚ Ğ³Ñ€ĞµĞ¹Ñ (72 Ñ‡Ğ°ÑĞ°), Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ÑÑ |
| **suspended** | ĞŸĞµÑ€ĞµĞ²ĞµĞ´Ñ‘Ğ½ Ğ½Ğ° free plan, Ğ½Ğ¾ ĞµÑ‰Ñ‘ Ğ¼Ğ¾Ğ¶ĞµĞ¼ Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ |
| **canceled** | ĞÑ‚Ğ¼ĞµĞ½ĞµĞ½Ğ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼, Ğ¿ĞµÑ€ĞµĞ²ĞµĞ´Ñ‘Ğ½ Ğ½Ğ° free plan |
| **expired** | Ğ—Ğ°ĞºĞ¾Ğ½Ñ‡Ğ¸Ğ»ÑÑ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´ Ğ¸ Ğ½Ğµ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ğ»Ğ¸, Ğ¿ĞµÑ€ĞµĞ²ĞµĞ´Ñ‘Ğ½ Ğ½Ğ° free plan |

### Retry Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°

ĞŸÑ€Ğ¸ Ğ½ĞµÑƒĞ´Ğ°Ñ‡Ğ½Ğ¾Ğ¼ Ğ°Ğ²Ñ‚Ğ¾ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğ¸:
1. **D0** (ÑÑ€Ğ°Ğ·Ñƒ): Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´ Ğ² GRACE, Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ
2. **Retry #1**: Ñ‡ĞµÑ€ĞµĞ· 12 Ñ‡Ğ°ÑĞ¾Ğ²
3. **Retry #2**: Ñ‡ĞµÑ€ĞµĞ· 24 Ñ‡Ğ°ÑĞ° Ğ¿Ğ¾ÑĞ»Ğµ Retry #1
4. **Retry #3**: Ñ‡ĞµÑ€ĞµĞ· 48 Ñ‡Ğ°ÑĞ¾Ğ² Ğ¿Ğ¾ÑĞ»Ğµ Retry #2
5. **D3-D4**: ĞµÑĞ»Ğ¸ Ğ²ÑÑ‘ ĞµÑ‰Ñ‘ fail â†’ SUSPENDED (free plan)
6. **Ğ§ĞµÑ€ĞµĞ· 7 Ğ´Ğ½ĞµĞ¹**: SUSPENDED â†’ EXPIRED (Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ ÑĞºĞ¸Ğ´ĞºĞ¸ 25%)

## ğŸ”§ Cloud Run Services

| Ğ¡ĞµÑ€Ğ²Ğ¸Ñ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Memory | Min/Max | Ğ¡ĞµĞºÑ€ĞµÑ‚Ñ‹ |
|--------|----------|--------|---------|---------|
| seeyay-bot | Telegram Ğ±Ğ¾Ñ‚ | 512Mi | 1/3 | telegram-bot-token |
| seeyay-api | Backend API | 1Gi | 0/10 | cloudpayments-* |
| seeyay-miniapp | React Mini App | 256Mi | 0/5 | - |

## ğŸ“ ĞŸĞ¾ÑĞ»Ğµ Ğ´ĞµĞ¿Ğ»Ğ¾Ñ

1. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚Ğµ URL Mini App Ğ¸Ğ· Cloud Run
2. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ Menu Button Ğ² @BotFather:
   - `/mybots` â†’ Ğ’Ğ°Ñˆ Ğ±Ğ¾Ñ‚ â†’ Bot Settings â†’ Menu Button
   - Ğ£ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ URL Mini App
3. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ webhook'Ğ¸ Ğ² CloudPayments (ÑĞ¼. CLOUDPAYMENTS_SETUP.md)
4. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Cloud Scheduler jobs Ğ´Ğ»Ñ cron Ğ·Ğ°Ğ´Ğ°Ñ‡
5. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ Ğ´Ğ¾Ğ¼ĞµĞ½ seeyay.app Ğ´Ğ»Ñ webhook'Ğ¾Ğ²

## ğŸ—„ï¸ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Firestore

### ĞšĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ: `users`

```javascript
{
  "telegram_id": 123456789,
  "username": "user",
  "plan": "basic",           // free | basic | pro
  "balance": 30,              // Ñ‚ĞµĞºÑƒÑ‰Ğ°Ñ ÑĞ½ĞµÑ€Ğ³Ğ¸Ñ
  "subscription": {
    "status": "active",       // active | grace | suspended | canceled | expired
    "plan": "basic",
    "token": "recurrent_token",
    "started_at": Timestamp,
    "next_billing_at": Timestamp,
    "grace_ends_at": Timestamp | null,
    "retry_count": 0,
    "last_retry_at": Timestamp | null,
    "canceled_at": Timestamp | null,
    "discount_percent": 0
  },
  "daily_energy_given_at": Timestamp,
  "created_at": Timestamp
}
```

### ĞšĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ: `payments`

```javascript
{
  "id": "auto",
  "user_id": "telegram_id",
  "type": "one_time | subscription | renewal",
  "product": "pack_10 | basic | pro",
  "amount": 499,
  "currency": "RUB",
  "status": "pending | completed | failed | refunded",
  "cloudpayments_transaction_id": "123456",
  "payment_method": "card | sbp",
  "receipt_url": "url",
  "error_message": null,
  "created_at": Timestamp,
  "completed_at": Timestamp
}
```

### ĞšĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ: `generations`

```javascript
{
  "id": "auto",
  "user_id": "telegram_id",
  "style_id": "luxury",
  "mode": "normal | pro",
  "status": "pending | completed | failed",
  "created_at": Timestamp
}
```

## ğŸ”’ Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

- âœ… Ğ¡ĞµĞºÑ€ĞµÑ‚Ñ‹ Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑÑ Ğ² Secret Manager
- âœ… IAM Ñ€Ğ¾Ğ»Ğ¸ Ğ´Ğ»Ñ ÑĞµÑ€Ğ²Ğ¸ÑĞ½Ñ‹Ñ… Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ¾Ğ²
- âœ… HTTPS Ğ´Ğ»Ñ Ğ²ÑĞµÑ… ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ² (Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ² Cloud Run)
- âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° HMAC Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¸ webhook'Ğ¾Ğ² CloudPayments
- âœ… ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ cron endpoints
- âœ… ĞÑ‚Ğ¾Ğ¼Ğ°Ñ€Ğ½Ñ‹Ğµ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸ Ğ² Firestore Ğ´Ğ»Ñ ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸
- âœ… Firestore Security Rules (Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ Ğ¿Ñ€Ğ¸ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸)

## ğŸ“± Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ² Telegram

Ğ‘Ğ¾Ñ‚ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ¾:
- âœ… Ğ£ÑĞ¿ĞµÑˆĞ½Ğ¾Ğ¹ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ğµ Ğ¿Ğ°ĞºĞµÑ‚Ğ°/Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸
- âœ… ĞŸÑ€Ğ¾Ğ´Ğ»ĞµĞ½Ğ¸Ğ¸ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸
- âš ï¸ ĞĞµÑƒĞ´Ğ°Ñ‡Ğ½Ğ¾Ğ¼ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğµ (GRACE)
- ğŸ˜” ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ğµ Ğ² SUSPENDED
- ğŸ ĞŸÑ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸ ÑĞºĞ¸Ğ´ĞºĞ¸ (EXPIRED/CANCELED)
- âš¡ ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾Ğ¹ ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸
- ğŸ’° Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚Ğµ ÑÑ€ĞµĞ´ÑÑ‚Ğ²

## ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ ĞºĞ°Ñ€Ñ‚Ñ‹ CloudPayments

- **Ğ£ÑĞ¿ĞµÑˆĞ½Ğ°Ñ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ğ°**: `4242 4242 4242 4242`
- **ĞÑ‚ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ½Ğ°Ñ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ğ°**: `4000 0000 0000 0002`
- **3-D Secure**: `4000 0000 0000 3220`

CVV: Ğ»ÑĞ±Ğ¾Ğ¹ (123), Ğ¡Ñ€Ğ¾Ğº: Ğ»ÑĞ±Ğ°Ñ Ğ±ÑƒĞ´ÑƒÑ‰Ğ°Ñ Ğ´Ğ°Ñ‚Ğ°

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ»Ğ¾Ğ³Ğ¾Ğ²

```bash
# Ğ›Ğ¾Ğ³Ğ¸ Cloud Run API
gcloud logging read "resource.type=cloud_run_revision AND resource.labels.service_name=seeyay-api" \
    --limit=50

# Ğ›Ğ¾Ğ³Ğ¸ Bot
gcloud logging read "resource.type=cloud_run_revision AND resource.labels.service_name=seeyay-bot" \
    --limit=50

# Ğ›Ğ¾Ğ³Ğ¸ Cloud Scheduler
gcloud logging read "resource.type=cloud_scheduler_job" \
    --limit=50
```

## ğŸ› Troubleshooting

### Webhook'Ğ¸ Ğ½Ğµ Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´ÑÑ‚
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ URL Ğ² Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°Ñ… CloudPayments
- Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ Ğ´Ğ¾Ğ¼ĞµĞ½ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ğ¿Ğ¾ HTTPS
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸ Cloud Run API

### ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¸
- Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ API Secret Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½ Ğ² Secret Manager
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ ĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²ĞºÑƒ (UTF-8)

### Cron jobs Ğ½Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑÑÑ‚ÑÑ
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ: `gcloud scheduler jobs list --location=europe-west4`
- Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ Cloud Run API Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

## ğŸ“š ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ÑÑÑ‹Ğ»ĞºĞ¸

- [CloudPayments Docs](https://developers.cloudpayments.ru/)
- [Telegram Bot API](https://core.telegram.org/bots/api)
- [Telegram Mini Apps](https://core.telegram.org/bots/webapps)
- [Vertex AI Gemini](https://cloud.google.com/vertex-ai/docs/generative-ai/model-reference/gemini)
- [Cloud Run Docs](https://cloud.google.com/run/docs)
- [Firestore Docs](https://cloud.google.com/firestore/docs)

## ğŸ“„ Ğ›Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ñ

MIT
